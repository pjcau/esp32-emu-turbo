(kicad_sch
  (version 20231120)
  (generator "eeschema")
  (generator_version "9.0")
  (uuid "00000016-cafe-4000-8000-000000000016")
  (paper "A4")
  (title_block
    (title "Storage - SD Card SPI")
    (comment 1 "ESP32 Emu Turbo - Handheld Retro Console")
    (comment 2 "Generated by scripts/generate_schematics")
  )

  (lib_symbols
    (symbol "SD_Module" (pin_names (offset 1.016)) (in_bom yes) (on_board yes)
      (property "Reference" "U" (at 0 7.62 0) (effects (font (size 1.27 1.27))))
      (property "Value" "SD_Card_SPI" (at 0 -7.62 0) (effects (font (size 1.27 1.27))))
      (property "Footprint" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide))
      (property "Datasheet" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide))
      (symbol "SD_Module_0_1" (rectangle (start -7.62 6.35) (end 7.62 -6.35) (stroke (width 0.254) (type default)) (fill (type background))))
      (symbol "SD_Module_1_1"
        (pin power_in line (at -10.16 3.81 0) (length 2.54) (name "VCC" (effects (font (size 1.016 1.016)))) (number "1" (effects (font (size 1.016 1.016)))))
        (pin power_in line (at -10.16 0 0) (length 2.54) (name "GND" (effects (font (size 1.016 1.016)))) (number "2" (effects (font (size 1.016 1.016)))))
        (pin input line (at 10.16 3.81 180) (length 2.54) (name "MOSI" (effects (font (size 1.016 1.016)))) (number "3" (effects (font (size 1.016 1.016)))))
        (pin output line (at 10.16 0 180) (length 2.54) (name "MISO" (effects (font (size 1.016 1.016)))) (number "4" (effects (font (size 1.016 1.016)))))
        (pin input line (at 10.16 -3.81 180) (length 2.54) (name "CLK" (effects (font (size 1.016 1.016)))) (number "5" (effects (font (size 1.016 1.016)))))
        (pin input line (at -10.16 -3.81 0) (length 2.54) (name "CS" (effects (font (size 1.016 1.016)))) (number "6" (effects (font (size 1.016 1.016)))))))
    (symbol "+3V3" (pin_names (offset 0) hide) (in_bom no) (on_board no)
      (property "Reference" "#PWR" (at 0 -3.81 0) (effects (font (size 1.27 1.27)) hide))
      (property "Value" "+3V3" (at 0 3.81 0) (effects (font (size 1.27 1.27))))
      (property "Footprint" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide))
      (property "Datasheet" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide))
      (symbol "+3V3_0_1"
        (polyline (pts (xy -0.762 1.27) (xy 0 2.54)) (stroke (width 0) (type default)) (fill (type none)))
        (polyline (pts (xy 0 0) (xy 0 2.54)) (stroke (width 0) (type default)) (fill (type none)))
        (polyline (pts (xy 0 2.54) (xy 0.762 1.27)) (stroke (width 0) (type default)) (fill (type none))))
      (symbol "+3V3_1_1" (pin power_in line (at 0 0 90) (length 0) (name "+3V3" (effects (font (size 1.27 1.27)))) (number "1" (effects (font (size 1.27 1.27)))))))
    (symbol "+5V" (pin_names (offset 0) hide) (in_bom no) (on_board no)
      (property "Reference" "#PWR" (at 0 -3.81 0) (effects (font (size 1.27 1.27)) hide))
      (property "Value" "+5V" (at 0 3.81 0) (effects (font (size 1.27 1.27))))
      (property "Footprint" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide))
      (property "Datasheet" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide))
      (symbol "+5V_0_1"
        (polyline (pts (xy -0.762 1.27) (xy 0 2.54)) (stroke (width 0) (type default)) (fill (type none)))
        (polyline (pts (xy 0 0) (xy 0 2.54)) (stroke (width 0) (type default)) (fill (type none)))
        (polyline (pts (xy 0 2.54) (xy 0.762 1.27)) (stroke (width 0) (type default)) (fill (type none))))
      (symbol "+5V_1_1" (pin power_in line (at 0 0 90) (length 0) (name "+5V" (effects (font (size 1.27 1.27)))) (number "1" (effects (font (size 1.27 1.27)))))))
    (symbol "GND" (pin_names (offset 0) hide) (in_bom no) (on_board no)
      (property "Reference" "#PWR" (at 0 -5.08 0) (effects (font (size 1.27 1.27)) hide))
      (property "Value" "GND" (at 0 -3.81 0) (effects (font (size 1.27 1.27))))
      (property "Footprint" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide))
      (property "Datasheet" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide))
      (symbol "GND_0_1" (polyline (pts (xy 0 0) (xy 0 -1.27) (xy 1.27 -1.27) (xy 0 -2.54) (xy -1.27 -1.27) (xy 0 -1.27)) (stroke (width 0) (type default)) (fill (type none))))
      (symbol "GND_1_1" (pin power_in line (at 0 0 270) (length 0) (name "GND" (effects (font (size 1.27 1.27)))) (number "1" (effects (font (size 1.27 1.27)))))))
  )

  (text "STORAGE - Micro SD Card" (at 30 25 0) (effects (font (size 5 5) bold) (justify left)))
  (text "SPI interface for ROM storage (SNES ROMs up to 6MB)" (at 30 33 0) (effects (font (size 2.54 2.54)) (justify left)))
  (symbol (lib_id "SD_Module") (at 148 110 0) (unit 1) (exclude_from_sim no) (in_bom yes) (on_board yes) (dnp no) (uuid "00000001-cafe-4000-8000-000000000001") (property "Reference" "U6" (at 148 105 0) (effects (font (size 1.27 1.27)))) (property "Value" "SD_Card_SPI" (at 148 115 0) (effects (font (size 1.27 1.27)))) (pin "1" (uuid "00000002-cafe-4000-8000-000000000002")) (pin "2" (uuid "00000003-cafe-4000-8000-000000000003")) (pin "3" (uuid "00000004-cafe-4000-8000-000000000004")) (pin "4" (uuid "00000005-cafe-4000-8000-000000000005")) (pin "5" (uuid "00000006-cafe-4000-8000-000000000006")) (pin "6" (uuid "00000007-cafe-4000-8000-000000000007")))
  (global_label "+3V3" (shape input) (at 118 106.19 0) (effects (font (size 1.27 1.27))) (uuid "00000008-cafe-4000-8000-000000000008") (property "Intersheetrefs" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide)))
  (wire (pts (xy 118 106.19) (xy 137.84 106.19)) (stroke (width 0) (type default)) (uuid "00000009-cafe-4000-8000-000000000009"))
  (symbol (lib_id "GND") (at 118 118 0) (unit 1) (exclude_from_sim no) (in_bom no) (on_board no) (dnp no) (uuid "0000000a-cafe-4000-8000-00000000000a") (property "Reference" "#PWR001" (at 118 116 0) (effects (font (size 1.27 1.27)) hide)) (property "Value" "GND" (at 118 120 0) (effects (font (size 1.27 1.27)) hide)) (pin "1" (uuid "0000000b-cafe-4000-8000-00000000000b")))
  (wire (pts (xy 137.84 110) (xy 118 110)) (stroke (width 0) (type default)) (uuid "0000000c-cafe-4000-8000-00000000000c"))
  (wire (pts (xy 118 110) (xy 118 118)) (stroke (width 0) (type default)) (uuid "0000000d-cafe-4000-8000-00000000000d"))
  (text "SPI bus:" (at 166 100 0) (effects (font (size 2 2) bold) (justify left)))
  (wire (pts (xy 158.16 106.19) (xy 183.16 106.19)) (stroke (width 0) (type default)) (uuid "0000000e-cafe-4000-8000-00000000000e"))
  (global_label "SD_MOSI" (shape bidirectional) (at 183.16 106.19 0) (effects (font (size 1.27 1.27))) (uuid "0000000f-cafe-4000-8000-00000000000f") (property "Intersheetrefs" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide)))
  (text "GPIO36" (at 198.16 106.19 0) (effects (font (size 1.5 1.5)) (justify left)))
  (wire (pts (xy 158.16 110) (xy 183.16 110)) (stroke (width 0) (type default)) (uuid "00000010-cafe-4000-8000-000000000010"))
  (global_label "SD_MISO" (shape bidirectional) (at 183.16 110 0) (effects (font (size 1.27 1.27))) (uuid "00000011-cafe-4000-8000-000000000011") (property "Intersheetrefs" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide)))
  (text "GPIO37" (at 198.16 110 0) (effects (font (size 1.5 1.5)) (justify left)))
  (wire (pts (xy 158.16 113.81) (xy 183.16 113.81)) (stroke (width 0) (type default)) (uuid "00000012-cafe-4000-8000-000000000012"))
  (global_label "SD_CLK" (shape bidirectional) (at 183.16 113.81 0) (effects (font (size 1.27 1.27))) (uuid "00000013-cafe-4000-8000-000000000013") (property "Intersheetrefs" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide)))
  (text "GPIO38" (at 198.16 113.81 0) (effects (font (size 1.5 1.5)) (justify left)))
  (text "Chip Select:" (at 90 111 0) (effects (font (size 2 2) bold) (justify left)))
  (global_label "SD_CS" (shape input) (at 118 113.81 0) (effects (font (size 1.27 1.27))) (uuid "00000014-cafe-4000-8000-000000000014") (property "Intersheetrefs" "" (at 0 0 0) (effects (font (size 1.27 1.27)) hide)))
  (wire (pts (xy 118 113.81) (xy 137.84 113.81)) (stroke (width 0) (type default)) (uuid "00000015-cafe-4000-8000-000000000015"))
  (text "GPIO39" (at 90 115 0) (effects (font (size 1.5 1.5)) (justify left)))
  (text "Design Notes:" (at 30 160 0) (effects (font (size 2.54 2.54) bold) (justify left)))
  (text "- SPI bus @ up to 40MHz (ESP32-S3 max for SD)" (at 30 168 0) (effects (font (size 2.54 2.54)) (justify left)))
  (text "- SNES ROMs: 256KB to 6MB typical (HiROM/LoROM)" (at 30 174 0) (effects (font (size 2.54 2.54)) (justify left)))
  (text "- FAT32 filesystem for easy ROM management via PC" (at 30 180 0) (effects (font (size 2.54 2.54)) (justify left)))
  (text "- 3.3V logic: no level shifter needed (module has built-in)" (at 30 186 0) (effects (font (size 2.54 2.54)) (justify left)))
  (text "- GPIO36-39 grouped for clean SPI trace routing on PCB" (at 30 192 0) (effects (font (size 2.54 2.54)) (justify left)))

  (sheet_instances (path "/" (page "5")))
)
