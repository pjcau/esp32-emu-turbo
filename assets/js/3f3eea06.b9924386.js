"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[848],{815(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>o,frontMatter:()=>d,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"schematics","title":"Electrical Schematics","description":"Complete electrical design for the ESP32 Emu Turbo handheld console.","source":"@site/docs/schematics.md","sourceDirName":".","slug":"/schematics","permalink":"/esp32-emu-turbo/docs/schematics","draft":false,"unlisted":false,"editUrl":"https://github.com/pjcau/esp32-emu-turbo/tree/main/website/docs/schematics.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"id":"schematics","title":"Electrical Schematics","sidebar_position":5},"sidebar":"projectSidebar","previous":{"title":"Bill of Materials (BOM)","permalink":"/esp32-emu-turbo/docs/components"},"next":{"title":"Breadboard Prototyping Guide","permalink":"/esp32-emu-turbo/docs/prototyping"}}');var r=t(4848),s=t(8453);const d={id:"schematics",title:"Electrical Schematics",sidebar_position:5},c="Electrical Schematics",l={},h=[{value:"System Block Diagram",id:"system-block-diagram",level:2},{value:"Power Supply Circuit",id:"power-supply-circuit",level:2},{value:"Design",id:"design",level:3},{value:"Power Budget",id:"power-budget",level:3},{value:"Display Interface",id:"display-interface",level:2},{value:"Audio Circuit",id:"audio-circuit",level:2},{value:"Input Section",id:"input-section",level:2},{value:"Button Matrix",id:"button-matrix",level:3},{value:"SD Card SPI Interface",id:"sd-card-spi-interface",level:2},{value:"Reset Circuit",id:"reset-circuit",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"electrical-schematics",children:"Electrical Schematics"})}),"\n",(0,r.jsx)(n.p,{children:"Complete electrical design for the ESP32 Emu Turbo handheld console."}),"\n",(0,r.jsxs)(n.admonition,{title:"Source files",type:"info",children:[(0,r.jsxs)(n.p,{children:["The KiCad 9.0 project files are in ",(0,r.jsx)(n.a,{href:"https://github.com/pjonny/esp32-emu-turbo/tree/main/hardware/kicad",children:(0,r.jsx)(n.code,{children:"hardware/kicad/"})}),". Open with ",(0,r.jsx)(n.a,{href:"https://www.kicad.org/",children:"KiCad 9.0+"}),"."]}),(0,r.jsx)(n.p,{children:"To export the schematic as SVG:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"make render-schematics\n"})})]}),"\n",(0,r.jsx)(n.h2,{id:"system-block-diagram",children:"System Block Diagram"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'                         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                         \u2502                  \u2502\n    USB-C \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502   IP5306 Module  \u2502\u2500\u2500\u2500\u2500 5V rail\n                         \u2502  (charge+boost)  \u2502\n                         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                  \u2502\n                          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                          \u2502               \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 LiPo Batt \u2502   \u2502  AMS1117   \u2502\n                    \u2502 3.7V      \u2502   \u2502 5V -> 3.3V \u2502\n                    \u2502 5000 mAh  \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2502 (105080)  \u2502         \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502 3.3V\n                                          \u2502\n                              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                              \u2502                       \u2502\n                              \u2502   ESP32-S3-WROOM-1    \u2502\n                              \u2502   N16R8               \u2502\n                              \u2502   (16MB Flash, 8MB    \u2502\n                              \u2502    Octal PSRAM)       \u2502\n                              \u2502                       \u2502\n                              \u2514\u2500\u2500\u252c\u2500\u2500\u252c\u2500\u2500\u252c\u2500\u2500\u252c\u2500\u2500\u252c\u2500\u2500\u252c\u2500\u2500\u252c\u2500\u2500\u2518\n                                 \u2502  \u2502  \u2502  \u2502  \u2502  \u2502  \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502  \u2502  \u2502  \u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502               \u2502  \u2502  \u2502  \u2502  \u2502             \u2502\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2518  \u2502  \u2514\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2510\n              \u2502 Display   \u2502  \u2502 SD Card\u2502  \u2502  \u2502 Audio  \u2502  \u2502 Buttons \u2502\n              \u2502 ST7796S   \u2502  \u2502 Module \u2502  \u2502  \u2502 I2S -> \u2502  \u2502 12x     \u2502\n              \u2502 4.0"      \u2502  \u2502 SPI    \u2502  \u2502  \u2502PAM8403 \u2502  \u2502 tact sw \u2502\n              \u2502 8080 par  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502  \u2502Speaker \u2502  \u2502 + L/R   \u2502\n              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                         \u2502\n                                   \u250c\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2510\n                                   \u2502 Joystick  \u2502\n                                   \u2502 PSP-style \u2502\n                                   \u2502 (optional)\u2502\n                                   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n'})}),"\n",(0,r.jsx)(n.h2,{id:"power-supply-circuit",children:"Power Supply Circuit"}),"\n",(0,r.jsx)(n.h3,{id:"design",children:"Design"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"USB-C \u2500\u2500> [5.1k\u03a9 CC1] \u2500\u2500\u2510\n          [5.1k\u03a9 CC2] \u2500\u2500\u2524\n                        \u251c\u2500\u2500> IP5306 Module \u2500\u2500> 5V OUT\n                        \u2502         \u2502\n                        \u2502    [LiPo 3.7V 5000mAh]\n                        \u2502\n                        \u2514\u2500\u2500> [C1 10\xb5F] \u2500\u2500> AMS1117-3.3 \u2500\u2500> [C2 22\xb5F] \u2500\u2500> 3.3V\n                                                \u2502\n                                               GND\n"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Component"}),(0,r.jsx)(n.th,{children:"Value"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"R1, R2"}),(0,r.jsx)(n.td,{children:"5.1 k\u03a9"}),(0,r.jsx)(n.td,{children:"USB-C CC pull-down (UFP identification)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"C1"}),(0,r.jsx)(n.td,{children:"10 \xb5F"}),(0,r.jsx)(n.td,{children:"AMS1117 input decoupling"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"C2"}),(0,r.jsx)(n.td,{children:"22 \xb5F"}),(0,r.jsx)(n.td,{children:"AMS1117 output stability (tantalum recommended)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"C3, C4"}),(0,r.jsx)(n.td,{children:"100 nF"}),(0,r.jsx)(n.td,{children:"ESP32-S3 VDD decoupling (place near pins)"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"power-budget",children:"Power Budget"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Consumer"}),(0,r.jsx)(n.th,{children:"Typical Current"}),(0,r.jsx)(n.th,{children:"Peak Current"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ESP32-S3 (dual-core active)"}),(0,r.jsx)(n.td,{children:"150 mA"}),(0,r.jsx)(n.td,{children:"350 mA"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ST7796S display + backlight"}),(0,r.jsx)(n.td,{children:"80 mA"}),(0,r.jsx)(n.td,{children:"120 mA"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PAM8403 + speaker"}),(0,r.jsx)(n.td,{children:"20 mA"}),(0,r.jsx)(n.td,{children:"100 mA"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SD card (read)"}),(0,r.jsx)(n.td,{children:"30 mA"}),(0,r.jsx)(n.td,{children:"100 mA"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Misc (pull-ups, LEDs)"}),(0,r.jsx)(n.td,{children:"10 mA"}),(0,r.jsx)(n.td,{children:"20 mA"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Total"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"~290 mA"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"~690 mA"})})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Battery life estimate:"})," 5000 mAh / 290 mA \u2248 ",(0,r.jsx)(n.strong,{children:"17 hours"})," typical"]}),"\n",(0,r.jsx)(n.h2,{id:"display-interface",children:"Display Interface"}),"\n",(0,r.jsx)(n.p,{children:"8-bit 8080 parallel connection to ST7796S module:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ESP32-S3                    ST7796S Module\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nGPIO4  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 D0\nGPIO5  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 D1\nGPIO6  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 D2\nGPIO7  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 D3\nGPIO8  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 D4\nGPIO9  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 D5\nGPIO10 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 D6\nGPIO11 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 D7\nGPIO12 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 CS\nGPIO13 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 RST\nGPIO14 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 DC/RS\nGPIO46 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 WR\nGPIO3  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 RD\nGPIO45 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 BL (backlight)\n3.3V   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 VCC\nGND    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 GND\n"})}),"\n",(0,r.jsx)(n.h2,{id:"audio-circuit",children:"Audio Circuit"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ESP32-S3                  PAM8403 Module         Speaker\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500         \u2500\u2500\u2500\u2500\u2500\u2500\u2500\nGPIO15 (BCLK) \u2500\u2500\u2510\nGPIO16 (LRCK) \u2500\u2500\u253c\u2500\u2500> I2S DAC \u2500\u2500> AUDIO_IN \u2500\u2500\u2510\nGPIO17 (DOUT) \u2500\u2500\u2518                            \u251c\u2500\u2500> SPK+ \u2500\u2500> [+] LS1 28mm\n                              [Vol 10k\u03a9]     \u2502           8\u03a9 0.5W\n5V \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> VCC           \u2514\u2500\u2500> SPK- \u2500\u2500> [-]\nGND \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> GND\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"I2S DAC",type:"note",children:(0,r.jsx)(n.p,{children:"The PAM8403 module accepts analog audio input. An external I2S DAC (MAX98357A or PCM5102 breakout) converts the digital I2S signal to analog before the amplifier. Alternatively, the ESP32-S3 internal DAC can be used for a simpler (lower quality) setup."})}),"\n",(0,r.jsx)(n.h2,{id:"input-section",children:"Input Section"}),"\n",(0,r.jsx)(n.p,{children:"All 12 buttons use the same circuit: active-low with pull-up resistor and debounce capacitor."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"3.3V \u2500\u2500[10k\u03a9]\u2500\u2500\u252c\u2500\u2500 GPIO_x\n               \u2502\n              [SW] (tact switch 6x6mm)\n               \u2502\n              GND\n"})}),"\n",(0,r.jsx)(n.p,{children:"Each button GPIO also has a 100 nF capacitor to GND for hardware debounce."}),"\n",(0,r.jsx)(n.h3,{id:"button-matrix",children:"Button Matrix"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Group"}),(0,r.jsx)(n.th,{children:"Buttons"}),(0,r.jsx)(n.th,{children:"GPIOs"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"D-pad"}),(0,r.jsx)(n.td,{children:"UP, DOWN, LEFT, RIGHT"}),(0,r.jsx)(n.td,{children:"GPIO40, 41, 42, 1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Face"}),(0,r.jsx)(n.td,{children:"A, B, X, Y"}),(0,r.jsx)(n.td,{children:"GPIO2, 48, 47, 21"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"System"}),(0,r.jsx)(n.td,{children:"START, SELECT"}),(0,r.jsx)(n.td,{children:"GPIO18, 0"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Shoulder"}),(0,r.jsx)(n.td,{children:"L, R"}),(0,r.jsx)(n.td,{children:"GPIO35, 19"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"sd-card-spi-interface",children:"SD Card SPI Interface"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ESP32-S3                  SD Card Module\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nGPIO36 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> MOSI\nGPIO37 <\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 MISO\nGPIO38 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> CLK\nGPIO39 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> CS\n3.3V   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> VCC\nGND    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> GND\n"})}),"\n",(0,r.jsx)(n.p,{children:"The SD card module has a built-in level shifter, so 3.3V logic is safe."}),"\n",(0,r.jsx)(n.h2,{id:"reset-circuit",children:"Reset Circuit"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"3.3V \u2500\u2500[R3 10k\u03a9]\u2500\u2500\u252c\u2500\u2500 EN (pin 3)\n                  \u2502\n                [C3 100nF]\n                  \u2502\n                 GND\n"})}),"\n",(0,r.jsx)(n.p,{children:"The RC circuit on the EN pin ensures a clean power-on reset. The time constant (10k\u03a9 \xd7 100nF = 1ms) provides sufficient delay for the internal voltage regulator to stabilize."})]})}function o(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453(e,n,t){t.d(n,{R:()=>d,x:()=>c});var i=t(6540);const r={},s=i.createContext(r);function d(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);